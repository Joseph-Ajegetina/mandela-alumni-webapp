<div class="container">
  <h3>My Profile</h3>
  <div class="main-content">

    <!-- USER SECTION -->
    <div class="user">
      <div class="profile">
<!-- Editing -->
<ng-container *ngIf="isEditing['user']; else staticAvatar">
  <label class="avatar-upload">
    <input type="file" hidden (change)="onImageSelected($event)" />
    <tui-avatar
      size="xl"
      class="avatar"
      appearance="negative"
      [src]="getProfileImageUrl(profileImage)"
    ></tui-avatar>
  </label>
</ng-container>

<!-- Static display -->
<ng-template #staticAvatar>
  <tui-avatar
    size="xl"
    class="avatar"
    appearance="negative"
    [src]="getProfileImageUrl(profileImage)"
  ></tui-avatar>
</ng-template>

      
        <div class="name">
          <h2 class="check">{{ currentUser.firstname }} {{ currentUser.lastname }}</h2>
          <p>{{ currentUser.profession || 'Web Developer'}}</p>
          <p>{{ currentUser.city || 'Accra'}}, {{ currentUser.country || 'Ghana' }}</p>
        </div>
      </div>
      <app-action-buttons
        [buttons]="getButtonsFor('user')"
        (buttonClick)="handleAction($event, 'user')"
      ></app-action-buttons>
    </div>

    <!-- PERSONAL SECTION -->
    <form class="personal" [formGroup]="profileForm">
      <div class="content">
        <h3>Personal Information</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="label">First Name:</span>
            <ng-container *ngIf="isEditing['personal'] else showFirstName">
              <input class="edit-input" formControlName="firstname"  />
            </ng-container>
            <ng-template #showFirstName>
              <span class="value">{{ currentUser.firstname }}</span>
            </ng-template>
          </div>

          <div class="info-item">
            <span class="label">Last Name:</span>
            <ng-container *ngIf="isEditing['personal']else showLastName">
              <input  class="edit-input" formControlName="lastname" />
            </ng-container>
            <ng-template #showLastName>
              <span class="value">{{ currentUser.lastname }}</span>
            </ng-template>
          </div>

          <div class="info-item">
            <span class="label">Email:</span>
            <ng-container *ngIf="isEditing['personal']else showEmail">
              <input  class="edit-input" formControlName="email" />
            </ng-container>
            <ng-template #showEmail>
              <span class="value">{{ currentUser.email }}</span>
            </ng-template>
          </div>

          <div class="info-item">
            <span class="label">Gender:</span>
            <ng-container *ngIf="isEditing['personal'] else showGender">
              <select  class="edit-input" formControlName="gender">
                <option value="Male">Male</option>
                <option value="Female">Female</option>
              </select>
            </ng-container>
            <ng-template #showGender>
              <span class="value">{{ currentUser.gender || 'Male' }}</span>
            </ng-template>
          </div>

          <div class="info-item">
            <span class="label">Phone:</span>
            <ng-container *ngIf="isEditing['personal'] else showPhone">
              <input  class="edit-input" formControlName="phone" />
            </ng-container>
            <ng-template #showPhone>
              <span class="value">{{ currentUser.phone }}</span>
            </ng-template>
          </div>

          <div class="info-item">
            <span class="label">Profession:</span>
            <ng-container *ngIf="isEditing['personal'] else showProfession">
              <input  class="edit-input" formControlName="profession" />
            </ng-container>
            <ng-template #showProfession>
              <span class="value">{{ currentUser.profession || 'Web Developer' }}</span>
            </ng-template>
          </div>
        </div>
      </div>

      <app-action-buttons
        [buttons]="getButtonsFor('personal')"
        (buttonClick)="handleAction($event, 'personal')"
      ></app-action-buttons>
    </form>

    <!-- ADDRESS SECTION -->
    <form class="address" [formGroup]="profileForm">
      <div class="content">
        <h3>Address</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="label">Country:</span>
            <ng-container *ngIf="isEditing['address'] else showCountry">
              <input  class="edit-input"formControlName="country" />
            </ng-container>
            <ng-template #showCountry>
              <span class="value">{{ currentUser.country || 'Ghana' }}</span>
            </ng-template>
          </div>

          <div class="info-item">
            <span class="label">City/State:</span>
            <ng-container *ngIf="isEditing['address'] else showCity">
              <input  class="edit-input" formControlName="city" />
            </ng-container>
            <ng-template #showCity>
              <span class="value">{{ currentUser.city || 'Accra' }}</span>
            </ng-template>
          </div>

          <div class="info-item">
            <span class="label">Postal Code:</span>
            <ng-container *ngIf="isEditing['address']; else showCity">
              <input  class="edit-input" formControlName="postalCode" />
            </ng-container>
            <ng-template #showPostal>
              <span class="value">{{ currentUser.postalCode || 'GHA-2025' }}</span>
            </ng-template>
          </div>

          <div class="info-item">
            <span class="label">Telephone:</span>
            <ng-container *ngIf="isEditing['address'] else showTel">
              <input  class="edit-input" formControlName="phone" />
            </ng-container>
            <ng-template #showTel>
              <span class="value">{{ currentUser.phone }}</span>
            </ng-template>
          </div>
        </div>
      </div>

      <app-action-buttons
        [buttons]="getButtonsFor('address')"
        (buttonClick)="handleAction($event, 'address')"
      ></app-action-buttons>
    </form>
  </div>
</div>
